

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IPv4 Firewall Configuration &mdash; VyOS 1.4.x (sagitta) documentation</title>
      <link rel="stylesheet" type="text/css" href="../../static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../static/sphinx-design.min.css?v=95c83b7e" />

  
    <link rel="shortcut icon" href="../../static/vyos-logo-icon.png"/>
      <script src="../../static/jquery.js?v=5d32c60e"></script>
      <script src="../../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../static/documentation_options.js?v=8f5ed1cd"></script>
      <script src="../../static/doctools.js?v=9bcbadda"></script>
      <script src="../../static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../static/design-tabs.js?v=f930bc37"></script>
    <script src="../../static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="IPv6 Firewall Configuration" href="ipv6.html" />
    <link rel="prev" title="Bridge Firewall Configuration" href="bridge.html" />
    <style>#vyos-header-iframe{position:fixed;top:0;left:0;right:0;z-index:999999999;width:100%;border:none}</style>
    <style>#vyos-footer-iframe{width:100%;border:none}</style>
    <link href="../../static/css/custom.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/lists.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/hints.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/headers.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/breadcrumbs.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/linkButtons.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/text.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/leftSidebar.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/scrolls.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/tables.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/installation/running-on-bare-metal.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/code-snippets.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/separate-commands.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/configuration/index.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/datatables.css" rel="stylesheet" type="text/css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script type="text/javascript" charset="utf8" src="../../static/js/datatables.js"></script>
    <script type="text/javascript" charset="utf8" src="../../static/js/tables.js"></script>
    <script type="text/javascript" charset="utf8" src="../../static/js/codecopier.js"></script>
    <script type="text/javascript" charset="utf8" src="../../static/js/sidebar.js"></script>
    <script type="text/javascript" charset="utf8" src="../../static/js/footer.js"></script>
    </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            VyOS
              <img src="../../static/vyos-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../introducing/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introducing/history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/index.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">First Steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation and Image Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick-start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html#configuration-overview">Configuration Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Adminguide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../container/index.html">Container</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Firewall</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="global-options.html">Global Options Firewall Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="groups.html">Firewall groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="bridge.html">Bridge Firewall Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">IPv4 Firewall Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#firewall-ipv4-rules">Firewall - IPv4 Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#synproxy">Synproxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operation-mode-firewall">Operation-mode Firewall</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ipv6.html">IPv6 Firewall Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="flowtables.html">Flowtables Firewall Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#zone-based-firewall">Zone-based firewall</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../highavailability/index.html">High availability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interfaces/index.html">Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../loadbalancing/index.html">Load-balancing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nat/index.html">NAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../policy/index.html">Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pki/index.html">PKI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/index.html">Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../service/index.html">Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../system/index.html">System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trafficpolicy/index.html">Traffic Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vpn/index.html">VPN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vrf/index.html">VRF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vrf/index.html#l3vpn-vrfs">L3VPN VRFs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../operation/index.html">Operation Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../automation/index.html">VyOS Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configexamples/index.html">Configuration Blueprints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configexamples/index.html#configuration-blueprints-autotest">Configuration Blueprints (autotest)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/build-vyos.html">Build VyOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/issues-features.html">Issues/Feature requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/upstream-packages.html">Upstream packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/testing.html">Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation.html">Write Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../coverage.html">Coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright Notice</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">VyOS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Configuration Guide</a></li>
          <li class="breadcrumb-item"><a href="index.html">Firewall</a></li>
      <li class="breadcrumb-item active">IPv4 Firewall Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../sources/configuration/firewall/ipv4.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ipv4-firewall-configuration">
<span id="firewall-ipv4-configuration"></span><h1>IPv4 Firewall Configuration<a class="headerlink" href="#ipv4-firewall-configuration" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>In this section there’s useful information of all firewall configuration that
can be done regarding IPv4, and appropiate op-mode commands.
Configuration commands covered in this section:</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4">
set firewall ipv4 …</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4" title="Permalink to this Command"></a></div></div>
<p>From main structure defined in
<a class="reference internal" href="index.html"><span class="doc">Firewall Overview</span></a>
in this section you can find detailed information only for the next part
of the general structure:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- set firewall
    * ipv4
         - forward
            + filter
         - input
            + filter
         - output
            + filter
         - name
            + custom_name
</pre></div>
</div>
<p>For transit traffic, which is received by the router and forwarded, base chain
is <strong>forward</strong>. A simplified packet flow diagram for transit traffic is shown
next:</p>
<figure class="align-default">
<img alt="../../images/firewall-fwd-packet-flow.png" src="../../images/firewall-fwd-packet-flow.png" />
</figure>
<p>Where firewall base chain to configure firewall filtering rules for transit
traffic is <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">firewall</span> <span class="pre">ipv4</span> <span class="pre">forward</span> <span class="pre">filter</span> <span class="pre">...</span></code>, which happens in stage 5,
highlightened with red color.</p>
<p>For traffic towards the router itself, base chain is <strong>input</strong>, while traffic
originated by the router, base chain is <strong>output</strong>.
A new simplified packet flow diagram is shown next, which shows the path
for traffic destinated to the router itself, and traffic generated by the
router (starting from circle number 6):</p>
<figure class="align-default">
<img alt="../../images/firewall-input-packet-flow.png" src="../../images/firewall-input-packet-flow.png" />
</figure>
<p>Base chain is for traffic toward the router is <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">firewall</span> <span class="pre">ipv4</span> <span class="pre">input</span>
<span class="pre">filter</span> <span class="pre">...</span></code></p>
<p>And base chain for traffic generated by the router is <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">firewall</span> <span class="pre">ipv4</span>
<span class="pre">output</span> <span class="pre">filter</span> <span class="pre">...</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Important note about default-actions:</strong>
If default action for any base chain is not defined, then the default
action is set to <strong>accept</strong> for that chain. For custom chains, if default
action is not defined, then the default-action is set to <strong>drop</strong></p>
</div>
<p>Custom firewall chains can be created, with commands
<code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">firewall</span> <span class="pre">ipv4</span> <span class="pre">name</span> <span class="pre">&lt;name&gt;</span> <span class="pre">...</span></code>. In order to use
such custom chain, a rule with <strong>action jump</strong>, and the appropiate <strong>target</strong>
should be defined in a base chain.</p>
</section>
<section id="firewall-ipv4-rules">
<h2>Firewall - IPv4 Rules<a class="headerlink" href="#firewall-ipv4-rules" title="Link to this heading"></a></h2>
<p>For firewall filtering, firewall rules needs to be created. Each rule is
numbered, has an action to apply if the rule is matched, and the ability
to specify multiple criteria matchers. Data packets go through the rules
from 1 - 999999, so order is crucial. At the first match the action of the
rule will be executed.</p>
<section id="actions">
<h3>Actions<a class="headerlink" href="#actions" title="Link to this heading"></a></h3>
<p>If a rule is defined, then an action must be defined for it. This tells the
firewall what to do if all criteria matchers defined for such rule do match.</p>
<p>The action can be :</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">accept</span></code>: accept the packet.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">continue</span></code>: continue parsing next rule.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">drop</span></code>: drop the packet.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reject</span></code>: reject the packet.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jump</span></code>: jump to another custom chain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span></code>: Return from the current chain and continue at the next rule
of the last chain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">queue</span></code>: Enqueue packet to userspace.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">synproxy</span></code>: synproxy the packet.</p></li>
</ul>
</div></blockquote>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return-synproxy">
set firewall ipv4 forward filter rule &lt;1-999999&gt; action [accept | continue | drop | jump | queue | reject | return | synproxy]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return-synproxy" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return-synproxy">
set firewall ipv4 input filter rule &lt;1-999999&gt; action [accept | continue | drop | jump | queue | reject | return | synproxy]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return-synproxy" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return">
set firewall ipv4 output filter rule &lt;1-999999&gt; action [accept | continue | drop | jump | queue | reject | return]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; action [accept | continue | drop | jump | queue | reject | return]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-action-accept-continue-drop-jump-queue-reject-return" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>This required setting defines the action of the current rule. If action is
set to jump, then jump-target is also needed.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-jump-target-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; jump-target &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-jump-target-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-jump-target-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; jump-target &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-jump-target-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-jump-target-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; jump-target &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-jump-target-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-jump-target-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; jump-target &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-jump-target-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>To be used only when action is set to <code class="docutils literal notranslate"><span class="pre">jump</span></code>. Use this command to specify
jump target.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-queue-0-65535">
set firewall ipv4 forward filter rule &lt;1-999999&gt; queue &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-queue-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-queue-0-65535">
set firewall ipv4 input filter rule &lt;1-999999&gt; queue &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-queue-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-queue-0-65535">
set firewall ipv4 output filter rule &lt;1-999999&gt; queue &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-queue-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-queue-0-65535">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; queue &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-queue-0-65535" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>To be used only when action is set to <code class="docutils literal notranslate"><span class="pre">queue</span></code>. Use this command to specify
queue target to use. Queue range is also supported.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-queue-options-bypass">
set firewall ipv4 forward filter rule &lt;1-999999&gt; queue-options bypass</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-queue-options-bypass" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-queue-options-bypass">
set firewall ipv4 input filter rule &lt;1-999999&gt; queue-options bypass</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-queue-options-bypass" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-queue-options-bypass">
set firewall ipv4 output filter rule &lt;1-999999&gt; queue-options bypass</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-queue-options-bypass" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-queue-options-bypass">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; queue-options bypass</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-queue-options-bypass" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>To be used only when action is set to <code class="docutils literal notranslate"><span class="pre">queue</span></code>. Use this command to let
packet go through firewall when no userspace software is connected to the
queue.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-queue-options-fanout">
set firewall ipv4 forward filter rule &lt;1-999999&gt; queue-options fanout</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-queue-options-fanout" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-queue-options-fanout">
set firewall ipv4 input filter rule &lt;1-999999&gt; queue-options fanout</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-queue-options-fanout" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-queue-options-fanout">
set firewall ipv4 output filter rule &lt;1-999999&gt; queue-options fanout</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-queue-options-fanout" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-queue-options-fanout">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; queue-options fanout</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-queue-options-fanout" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>To be used only when action is set to <code class="docutils literal notranslate"><span class="pre">queue</span></code>. Use this command to
distribute packets between several queues.</p>
</div>
</div>
<p>Also, <strong>default-action</strong> is an action that takes place whenever a packet does
not match any rule in it’s chain. For base chains, possible options for
<strong>default-action</strong> are <strong>accept</strong> or <strong>drop</strong>.</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-default-action-accept-drop">
set firewall ipv4 forward filter default-action [accept | drop]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-default-action-accept-drop" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-default-action-accept-drop">
set firewall ipv4 input filter default-action [accept | drop]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-default-action-accept-drop" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-default-action-accept-drop">
set firewall ipv4 output filter default-action [accept | drop]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-default-action-accept-drop" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-default-action-accept-drop-jump-queue-reject-return">
set firewall ipv4 name &lt;name&gt; default-action [accept | drop | jump | queue | reject | return]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-default-action-accept-drop-jump-queue-reject-return" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>This set the default action of the rule-set if no rule matched a packet
criteria. If default-action is set to <code class="docutils literal notranslate"><span class="pre">jump</span></code>, then
<code class="docutils literal notranslate"><span class="pre">default-jump-target</span></code> is also needed. Note that for base chains, default
action can only be set to <code class="docutils literal notranslate"><span class="pre">accept</span></code> or <code class="docutils literal notranslate"><span class="pre">drop</span></code>, while on custom chain,
more actions are available.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-default-jump-target-text">
set firewall ipv4 name &lt;name&gt; default-jump-target &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-default-jump-target-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>To be used only when <code class="docutils literal notranslate"><span class="pre">defult-action</span></code> is set to <code class="docutils literal notranslate"><span class="pre">jump</span></code>. Use this
command to specify jump target for default rule.</p>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Important note about default-actions:</strong>
If default action for any base chain is not defined, then the default
action is set to <strong>accept</strong> for that chain. For custom chains, if default
action is not defined, then the default-action is set to <strong>drop</strong>.</p>
</div>
</section>
<section id="firewall-logs">
<h3>Firewall Logs<a class="headerlink" href="#firewall-logs" title="Link to this heading"></a></h3>
<p>Logging can be enable for every single firewall rule. If enabled, other
log options can be defined.</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log">
set firewall ipv4 forward filter rule &lt;1-999999&gt; log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log">
set firewall ipv4 input filter rule &lt;1-999999&gt; log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log">
set firewall ipv4 output filter rule &lt;1-999999&gt; log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Enable logging for the matched packet. If this configuration command is not
present, then log is not enabled.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-default-log">
set firewall ipv4 forward filter default-log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-default-log" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-default-log">
set firewall ipv4 input filter default-log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-default-log" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-default-log">
set firewall ipv4 output filter default-log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-default-log" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-default-log">
set firewall ipv4 name &lt;name&gt; default-log</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-default-log" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Use this command to enable the logging of the default action on
the specified chain.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug">
set firewall ipv4 forward filter rule &lt;1-999999&gt; log-options level [emerg | alert | crit | err | warn | notice | info | debug]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug">
set firewall ipv4 input filter rule &lt;1-999999&gt; log-options level [emerg | alert | crit | err | warn | notice | info | debug]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug">
set firewall ipv4 output filter rule &lt;1-999999&gt; log-options level [emerg | alert | crit | err | warn | notice | info | debug]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; log-options level [emerg | alert | crit | err | warn | notice | info | debug]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-level-emerg-alert-crit-err-warn-notice-info-debug" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Define log-level. Only applicable if rule log is enable.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-group-0-65535">
set firewall ipv4 forward filter rule &lt;1-999999&gt; log-options group &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-group-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-group-0-65535">
set firewall ipv4 input filter rule &lt;1-999999&gt; log-options group &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-group-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-group-0-65535">
set firewall ipv4 output filter rule &lt;1-999999&gt; log-options group &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-group-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-group-0-65535">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; log-options group &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-group-0-65535" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Define log group to send message to. Only applicable if rule log is enable.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-snapshot-length-0-9000">
set firewall ipv4 forward filter rule &lt;1-999999&gt; log-options snapshot-length &lt;0-9000&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-snapshot-length-0-9000" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-snapshot-length-0-9000">
set firewall ipv4 input filter rule &lt;1-999999&gt; log-options snapshot-length &lt;0-9000&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-snapshot-length-0-9000" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-snapshot-length-0-9000">
set firewall ipv4 output filter rule &lt;1-999999&gt; log-options snapshot-length &lt;0-9000&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-snapshot-length-0-9000" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-snapshot-length-0-9000">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; log-options snapshot-length &lt;0-9000&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-snapshot-length-0-9000" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Define length of packet payload to include in netlink message. Only
applicable if rule log is enable and log group is defined.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-queue-threshold-0-65535">
set firewall ipv4 forward filter rule &lt;1-999999&gt; log-options queue-threshold &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-log-options-queue-threshold-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-queue-threshold-0-65535">
set firewall ipv4 input filter rule &lt;1-999999&gt; log-options queue-threshold &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-log-options-queue-threshold-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-queue-threshold-0-65535">
set firewall ipv4 output filter rule &lt;1-999999&gt; log-options queue-threshold &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-log-options-queue-threshold-0-65535" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-queue-threshold-0-65535">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; log-options queue-threshold &lt;0-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-log-options-queue-threshold-0-65535" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Define number of packets to queue inside the kernel before sending them to
userspace. Only applicable if rule log is enable and log group is defined.</p>
</div>
</div>
</section>
<section id="firewall-description">
<h3>Firewall Description<a class="headerlink" href="#firewall-description" title="Link to this heading"></a></h3>
<p>For reference, a description can be defined for every single rule, and for
every defined custom chain.</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-description-text">
set firewall ipv4 name &lt;name&gt; description &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-description-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Provide a rule-set description to a custom firewall chain.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-description-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; description &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-description-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-description-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; description &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-description-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-description-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; description &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-description-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-description-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; description &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-description-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Provide a description for each rule.</p>
</div>
</div>
</section>
<section id="rule-status">
<h3>Rule Status<a class="headerlink" href="#rule-status" title="Link to this heading"></a></h3>
<p>When defining a rule, it is enable by default. In some cases, it is useful to
just disable the rule, rather than removing it.</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-disable">
set firewall ipv4 forward filter rule &lt;1-999999&gt; disable</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-disable" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-disable">
set firewall ipv4 input filter rule &lt;1-999999&gt; disable</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-disable" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-disable">
set firewall ipv4 output filter rule &lt;1-999999&gt; disable</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-disable" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-disable">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; disable</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-disable" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Command for disabling a rule but keep it in the configuration.</p>
</div>
</div>
</section>
<section id="matching-criteria">
<h3>Matching criteria<a class="headerlink" href="#matching-criteria" title="Link to this heading"></a></h3>
<p>There are a lot of matching criteria against which the packet can be tested.</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-connection-status-nat-destination-source">
set firewall ipv4 forward filter rule &lt;1-999999&gt; connection-status nat [destination | source]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-connection-status-nat-destination-source" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-connection-status-nat-destination-source">
set firewall ipv4 input filter rule &lt;1-999999&gt; connection-status nat [destination | source]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-connection-status-nat-destination-source" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-connection-status-nat-destination-source">
set firewall ipv4 output filter rule &lt;1-999999&gt; connection-status nat [destination | source]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-connection-status-nat-destination-source" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-connection-status-nat-destination-source">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; connection-status nat [destination | source]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-connection-status-nat-destination-source" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match criteria based on nat connection status.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-connection-mark-1-2147483647">
set firewall ipv4 forward filter rule &lt;1-999999&gt; connection-mark &lt;1-2147483647&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-connection-mark-1-2147483647" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-connection-mark-1-2147483647">
set firewall ipv4 input filter rule &lt;1-999999&gt; connection-mark &lt;1-2147483647&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-connection-mark-1-2147483647" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-connection-mark-1-2147483647">
set firewall ipv4 output filter rule &lt;1-999999&gt; connection-mark &lt;1-2147483647&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-connection-mark-1-2147483647" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-connection-mark-1-2147483647">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; connection-mark &lt;1-2147483647&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-connection-mark-1-2147483647" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match criteria based on connection mark.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-address-address-addressrange-cidr">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-address-address-addressrange-cidr" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-address-address-addressrange-cidr">
set firewall ipv4 input filter rule &lt;1-999999&gt; source address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-address-address-addressrange-cidr" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-address-address-addressrange-cidr">
set firewall ipv4 output filter rule &lt;1-999999&gt; source address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-address-address-addressrange-cidr" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-address-address-addressrange-cidr">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-address-address-addressrange-cidr" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-address-address-addressrange-cidr">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-address-address-addressrange-cidr" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-address-address-addressrange-cidr">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-address-address-addressrange-cidr" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-address-address-addressrange-cidr">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-address-address-addressrange-cidr" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-address-address-addressrange-cidr">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination address [address | addressrange | CIDR]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-address-address-addressrange-cidr" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match criteria based on source and/or destination address. This is similar
to the network groups part, but here you are able to negate the matching
addresses.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>set firewall ipv4 name FOO rule 50 source address 192.0.2.10-192.0.2.11
# with a &#39;!&#39; the rule match everything except the specified subnet
set firewall ipv4 input filter FOO rule 51 source address !203.0.113.0/24
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-address-mask-address">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-address-mask-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-address-mask-address">
set firewall ipv4 input filter rule &lt;1-999999&gt; source address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-address-mask-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-address-mask-address">
set firewall ipv4 output filter rule &lt;1-999999&gt; source address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-address-mask-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-address-mask-address">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-address-mask-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-address-mask-address">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-address-mask-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-address-mask-address">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-address-mask-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-address-mask-address">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-address-mask-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-address-mask-address">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination address-mask [address]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-address-mask-address" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>An arbitrary netmask can be applied to mask addresses to only match against
a specific portion.</p>
<p>This functions for both individual addresses and address groups.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Match any IPv4 address with `11` as the 2nd octet and `13` as the forth octet
set firewall ipv4 name FOO rule 100 destination address 0.11.0.13
set firewall ipv4 name FOO rule 100 destination address-mask 0.255.0.255
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-fqdn-fqdn">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-fqdn-fqdn" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-fqdn-fqdn">
set firewall ipv4 input filter rule &lt;1-999999&gt; source fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-fqdn-fqdn" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-fqdn-fqdn">
set firewall ipv4 output filter rule &lt;1-999999&gt; source fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-fqdn-fqdn" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-fqdn-fqdn">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-fqdn-fqdn" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-fqdn-fqdn">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-fqdn-fqdn" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-fqdn-fqdn">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-fqdn-fqdn" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-fqdn-fqdn">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-fqdn-fqdn" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-fqdn-fqdn">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination fqdn &lt;fqdn&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-fqdn-fqdn" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Specify a Fully Qualified Domain Name as source/destination matcher. Ensure
router is able to resolve such dns query.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-geoip-country-code-country">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-geoip-country-code-country">
set firewall ipv4 input filter rule &lt;1-999999&gt; source geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-geoip-country-code-country">
set firewall ipv4 output filter rule &lt;1-999999&gt; source geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-geoip-country-code-country">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-geoip-country-code-country">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-geoip-country-code-country">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-geoip-country-code-country">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-geoip-country-code-country">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination geoip country-code &lt;country&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-geoip-country-code-country" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-geoip-inverse-match">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-geoip-inverse-match" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-geoip-inverse-match">
set firewall ipv4 input filter rule &lt;1-999999&gt; source geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-geoip-inverse-match" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-geoip-inverse-match">
set firewall ipv4 output filter rule &lt;1-999999&gt; source geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-geoip-inverse-match" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-geoip-inverse-match">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-geoip-inverse-match" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-geoip-inverse-match">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-geoip-inverse-match" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-geoip-inverse-match">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-geoip-inverse-match" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-geoip-inverse-match">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-geoip-inverse-match" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-geoip-inverse-match">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination geoip inverse-match</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-geoip-inverse-match" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match IP addresses based on its geolocation. More info: <a class="reference external" href="https://wiki.nftables.org/wiki-nftables/index.php/GeoIP_matching">geoip matching</a>.
Use inverse-match to match anything except the given country-codes.</p>
</div>
</div>
<p>Data is provided by DB-IP.com under CC-BY-4.0 license. Attribution required,
permits redistribution so we can include a database in images(~3MB
compressed). Includes cron script (manually callable by op-mode update
geoip) to keep database and rules updated.</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-mac-address-mac-address">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source mac-address &lt;mac-address&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-mac-address-mac-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-mac-address-mac-address">
set firewall ipv4 input filter rule &lt;1-999999&gt; source mac-address &lt;mac-address&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-mac-address-mac-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-mac-address-mac-address">
set firewall ipv4 output filter rule &lt;1-999999&gt; source mac-address &lt;mac-address&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-mac-address-mac-address" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-mac-address-mac-address">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source mac-address &lt;mac-address&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-mac-address-mac-address" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Only in the source criteria, you can specify a mac-address.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>set firewall ipv4 input filter rule 100 source mac-address 00:53:00:11:22:33
set firewall ipv4 input filter rule 101 source mac-address !00:53:00:aa:12:34
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-port-1-65535-portname-start-end">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-port-1-65535-portname-start-end">
set firewall ipv4 input filter rule &lt;1-999999&gt; source port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-port-1-65535-portname-start-end">
set firewall ipv4 output filter rule &lt;1-999999&gt; source port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-port-1-65535-portname-start-end">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-port-1-65535-portname-start-end">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-port-1-65535-portname-start-end">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-port-1-65535-portname-start-end">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-port-1-65535-portname-start-end">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination port [1-65535 | portname | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-port-1-65535-portname-start-end" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>A port can be set with a port number or a name which is here
defined: <code class="docutils literal notranslate"><span class="pre">/etc/services</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>set firewall ipv4 forward filter rule 10 source port &#39;22&#39;
set firewall ipv4 forward filter rule 11 source port &#39;!http&#39;
set firewall ipv4 forward filter rule 12 source port &#39;https&#39;
</pre></div>
</div>
<p>Multiple source ports can be specified as a comma-separated list.
The whole list can also be “negated” using <code class="docutils literal notranslate"><span class="pre">!</span></code>. For example:</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-address-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-address-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; source group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-address-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; source group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-address-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-address-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-address-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-address-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-address-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination group address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-address-group-name-name" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Use a specific address-group. Prepend character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted matching
criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-dynamic-address-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-dynamic-address-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; source group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-dynamic-address-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; source group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-dynamic-address-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-dynamic-address-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-dynamic-address-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-dynamic-address-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-dynamic-address-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination group dynamic-address-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-dynamic-address-group-name-name" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Use a specific dynamic-address-group. Prepend character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted
matching criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-network-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-network-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-network-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; source group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-network-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-network-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; source group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-network-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-network-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-network-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-network-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-network-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-network-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-network-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-network-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-network-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-network-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination group network-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-network-group-name-name" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Use a specific network-group. Prepend character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted matching
criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-port-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-port-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-port-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; source group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-port-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-port-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; source group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-port-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-port-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-port-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-port-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-port-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-port-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-port-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-port-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-port-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-port-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination group port-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-port-group-name-name" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Use a specific port-group. Prepend character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted matching
criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-domain-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-domain-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-domain-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; source group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-domain-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-domain-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; source group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-domain-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-domain-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-domain-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-domain-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-domain-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-domain-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-domain-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-domain-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-domain-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-domain-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination group domain-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-domain-group-name-name" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Use a specific domain-group. Prepend character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted matching
criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-mac-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; source group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-source-group-mac-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-mac-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; source group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-source-group-mac-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-mac-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; source group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-source-group-mac-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-mac-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; source group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-source-group-mac-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-mac-group-name-name">
set firewall ipv4 forward filter rule &lt;1-999999&gt; destination group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-destination-group-mac-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-mac-group-name-name">
set firewall ipv4 input filter rule &lt;1-999999&gt; destination group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-destination-group-mac-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-mac-group-name-name">
set firewall ipv4 output filter rule &lt;1-999999&gt; destination group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-destination-group-mac-group-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-mac-group-name-name">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; destination group mac-group &lt;name | !name&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-destination-group-mac-group-name-name" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Use a specific mac-group. Prepend character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted matching
criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-dscp-0-63-start-end">
set firewall ipv4 forward filter rule &lt;1-999999&gt; dscp [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-dscp-0-63-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-dscp-0-63-start-end">
set firewall ipv4 input filter rule &lt;1-999999&gt; dscp [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-dscp-0-63-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-dscp-0-63-start-end">
set firewall ipv4 output filter rule &lt;1-999999&gt; dscp [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-dscp-0-63-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-dscp-0-63-start-end">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; dscp [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-dscp-0-63-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-dscp-exclude-0-63-start-end">
set firewall ipv4 forward filter rule &lt;1-999999&gt; dscp-exclude [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-dscp-exclude-0-63-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-dscp-exclude-0-63-start-end">
set firewall ipv4 input filter rule &lt;1-999999&gt; dscp-exclude [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-dscp-exclude-0-63-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-dscp-exclude-0-63-start-end">
set firewall ipv4 output filter rule &lt;1-999999&gt; dscp-exclude [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-dscp-exclude-0-63-start-end" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-dscp-exclude-0-63-start-end">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; dscp-exclude [0-63 | start-end]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-dscp-exclude-0-63-start-end" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on dscp value.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-fragment-match-frag-match-non-frag">
set firewall ipv4 forward filter rule &lt;1-999999&gt; fragment [match-frag | match-non-frag]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-fragment-match-frag-match-non-frag" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-fragment-match-frag-match-non-frag">
set firewall ipv4 input filter rule &lt;1-999999&gt; fragment [match-frag | match-non-frag]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-fragment-match-frag-match-non-frag" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-fragment-match-frag-match-non-frag">
set firewall ipv4 output filter rule &lt;1-999999&gt; fragment [match-frag | match-non-frag]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-fragment-match-frag-match-non-frag" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-fragment-match-frag-match-non-frag">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; fragment [match-frag | match-non-frag]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-fragment-match-frag-match-non-frag" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on fragment criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-icmp-code-type-0-255">
set firewall ipv4 forward filter rule &lt;1-999999&gt; icmp [code | type] &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-icmp-code-type-0-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-icmp-code-type-0-255">
set firewall ipv4 input filter rule &lt;1-999999&gt; icmp [code | type] &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-icmp-code-type-0-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-icmp-code-type-0-255">
set firewall ipv4 output filter rule &lt;1-999999&gt; icmp [code | type] &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-icmp-code-type-0-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-icmp-code-type-0-255">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; icmp [code | type] &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-icmp-code-type-0-255" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on icmp code and type.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-icmp-type-name-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; icmp type-name &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-icmp-type-name-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-icmp-type-name-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; icmp type-name &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-icmp-type-name-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-icmp-type-name-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; icmp type-name &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-icmp-type-name-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-icmp-type-name-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; icmp type-name &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-icmp-type-name-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on icmp type-name criteria. Use tab for information
about what <strong>type-name</strong> criteria are supported.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-inbound-interface-name-iface">
set firewall ipv4 forward filter rule &lt;1-999999&gt; inbound-interface name &lt;iface&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-inbound-interface-name-iface" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-inbound-interface-name-iface">
set firewall ipv4 input filter rule &lt;1-999999&gt; inbound-interface name &lt;iface&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-inbound-interface-name-iface" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-inbound-interface-name-iface">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; inbound-interface name &lt;iface&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-inbound-interface-name-iface" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on inbound interface. Wilcard <code class="docutils literal notranslate"><span class="pre">*</span></code> can be used.
For example: <code class="docutils literal notranslate"><span class="pre">eth2*</span></code>. Prepending character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted matching
criteria is also supportd. For example <code class="docutils literal notranslate"><span class="pre">!eth2</span></code></p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-inbound-interface-group-iface-group">
set firewall ipv4 forward filter rule &lt;1-999999&gt; inbound-interface group &lt;iface_group&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-inbound-interface-group-iface-group" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-inbound-interface-group-iface-group">
set firewall ipv4 input filter rule &lt;1-999999&gt; inbound-interface group &lt;iface_group&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-inbound-interface-group-iface-group" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-inbound-interface-group-iface-group">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; inbound-interface group &lt;iface_group&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-inbound-interface-group-iface-group" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on inbound interface group. Prepending character <code class="docutils literal notranslate"><span class="pre">!</span></code> for
inverted matching criteria is also supportd. For example <code class="docutils literal notranslate"><span class="pre">!IFACE_GROUP</span></code></p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-outbound-interface-name-iface">
set firewall ipv4 forward filter rule &lt;1-999999&gt; outbound-interface name &lt;iface&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-outbound-interface-name-iface" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-outbound-interface-name-iface">
set firewall ipv4 output filter rule &lt;1-999999&gt; outbound-interface name &lt;iface&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-outbound-interface-name-iface" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-outbound-interface-name-iface">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; outbound-interface name &lt;iface&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-outbound-interface-name-iface" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on outbound interface. Wilcard <code class="docutils literal notranslate"><span class="pre">*</span></code> can be used.
For example: <code class="docutils literal notranslate"><span class="pre">eth2*</span></code>. Prepending character <code class="docutils literal notranslate"><span class="pre">!</span></code> for inverted matching
criteria is also supportd. For example <code class="docutils literal notranslate"><span class="pre">!eth2</span></code></p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-outbound-interface-group-iface-group">
set firewall ipv4 forward filter rule &lt;1-999999&gt; outbound-interface group &lt;iface_group&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-outbound-interface-group-iface-group" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-outbound-interface-group-iface-group">
set firewall ipv4 output filter rule &lt;1-999999&gt; outbound-interface group &lt;iface_group&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-outbound-interface-group-iface-group" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-outbound-interface-group-iface-group">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; outbound-interface group &lt;iface_group&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-outbound-interface-group-iface-group" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on outbound interface group. Prepending character <code class="docutils literal notranslate"><span class="pre">!</span></code> for
inverted matching criteria is also supportd. For example <code class="docutils literal notranslate"><span class="pre">!IFACE_GROUP</span></code></p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-ipsec-match-ipsec-match-none">
set firewall ipv4 forward filter rule &lt;1-999999&gt; ipsec [match-ipsec | match-none]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-ipsec-match-ipsec-match-none" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-ipsec-match-ipsec-match-none">
set firewall ipv4 input filter rule &lt;1-999999&gt; ipsec [match-ipsec | match-none]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-ipsec-match-ipsec-match-none" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-ipsec-match-ipsec-match-none">
set firewall ipv4 output filter rule &lt;1-999999&gt; ipsec [match-ipsec | match-none]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-ipsec-match-ipsec-match-none" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-ipsec-match-ipsec-match-none">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; ipsec [match-ipsec | match-none]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-ipsec-match-ipsec-match-none" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on ipsec criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-limit-burst-0-4294967295">
set firewall ipv4 forward filter rule &lt;1-999999&gt; limit burst &lt;0-4294967295&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-limit-burst-0-4294967295" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-limit-burst-0-4294967295">
set firewall ipv4 input filter rule &lt;1-999999&gt; limit burst &lt;0-4294967295&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-limit-burst-0-4294967295" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-limit-burst-0-4294967295">
set firewall ipv4 output filter rule &lt;1-999999&gt; limit burst &lt;0-4294967295&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-limit-burst-0-4294967295" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-limit-burst-0-4294967295">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; limit burst &lt;0-4294967295&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-limit-burst-0-4294967295" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on the maximum number of packets to allow in excess of rate.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-limit-rate-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; limit rate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-limit-rate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-limit-rate-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; limit rate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-limit-rate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-limit-rate-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; limit rate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-limit-rate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-limit-rate-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; limit rate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-limit-rate-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on the maximum average rate, specified as <strong>integer/unit</strong>.
For example <strong>5/minutes</strong></p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-packet-length-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; packet-length &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-packet-length-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-packet-length-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; packet-length &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-packet-length-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-packet-length-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; packet-length &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-packet-length-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-packet-length-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; packet-length &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-packet-length-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-packet-length-exclude-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; packet-length-exclude &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-packet-length-exclude-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-packet-length-exclude-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; packet-length-exclude &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-packet-length-exclude-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-packet-length-exclude-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; packet-length-exclude &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-packet-length-exclude-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-packet-length-exclude-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; packet-length-exclude &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-packet-length-exclude-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on packet length criteria. Multiple values from 1 to 65535
and ranges are supported.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-packet-type-broadcast-host-multicast-other">
set firewall ipv4 forward filter rule &lt;1-999999&gt; packet-type [broadcast | host | multicast | other]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-packet-type-broadcast-host-multicast-other" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-packet-type-broadcast-host-multicast-other">
set firewall ipv4 input filter rule &lt;1-999999&gt; packet-type [broadcast | host | multicast | other]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-packet-type-broadcast-host-multicast-other" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-packet-type-broadcast-host-multicast-other">
set firewall ipv4 output filter rule &lt;1-999999&gt; packet-type [broadcast | host | multicast | other]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-packet-type-broadcast-host-multicast-other" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-packet-type-broadcast-host-multicast-other">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; packet-type [broadcast | host | multicast | other]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-packet-type-broadcast-host-multicast-other" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on packet type criteria.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-protocol-text-0-255-all-tcp-udp">
set firewall ipv4 forward filter rule &lt;1-999999&gt; protocol [&lt;text&gt; | &lt;0-255&gt; | all | tcp_udp]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-protocol-text-0-255-all-tcp-udp" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-protocol-text-0-255-all-tcp-udp">
set firewall ipv4 input filter rule &lt;1-999999&gt; protocol [&lt;text&gt; | &lt;0-255&gt; | all | tcp_udp]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-protocol-text-0-255-all-tcp-udp" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-protocol-text-0-255-all-tcp-udp">
set firewall ipv4 output filter rule &lt;1-999999&gt; protocol [&lt;text&gt; | &lt;0-255&gt; | all | tcp_udp]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-protocol-text-0-255-all-tcp-udp" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-protocol-text-0-255-all-tcp-udp">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; protocol [&lt;text&gt; | &lt;0-255&gt; | all | tcp_udp]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-protocol-text-0-255-all-tcp-udp" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match a protocol criteria. A protocol number or a name which is here
defined: <code class="docutils literal notranslate"><span class="pre">/etc/protocols</span></code>.
Special names are <code class="docutils literal notranslate"><span class="pre">all</span></code> for all protocols and <code class="docutils literal notranslate"><span class="pre">tcp_udp</span></code> for tcp and udp
based packets. The <code class="docutils literal notranslate"><span class="pre">!</span></code> negate the selected protocol.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>set firewall ipv4 forward fitler rule 10 protocol tcp_udp
set firewall ipv4 forward fitler rule 11 protocol !tcp_udp
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-count-1-255">
set firewall ipv4 forward filter rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-count-1-255">
set firewall ipv4 input filter rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-count-1-255">
set firewall ipv4 output filter rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-count-1-255">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 forward filter rule &lt;1-999999&gt; recent time [second | minute | hour]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 input filter rule &lt;1-999999&gt; recent time [second | minute | hour]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 output filter rule &lt;1-999999&gt; recent time [second | minute | hour]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; recent time [second | minute | hour]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match bases on recently seen sources.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-tcp-flags-not-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; tcp flags [not] &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-tcp-flags-not-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-tcp-flags-not-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; tcp flags [not] &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-tcp-flags-not-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-tcp-flags-not-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; tcp flags [not] &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-tcp-flags-not-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-tcp-flags-not-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; tcp flags [not] &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-tcp-flags-not-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Allowed values fpr TCP flags: <code class="docutils literal notranslate"><span class="pre">ack</span></code>, <code class="docutils literal notranslate"><span class="pre">cwr</span></code>, <code class="docutils literal notranslate"><span class="pre">ecn</span></code>, <code class="docutils literal notranslate"><span class="pre">fin</span></code>, <code class="docutils literal notranslate"><span class="pre">psh</span></code>,
<code class="docutils literal notranslate"><span class="pre">rst</span></code>, <code class="docutils literal notranslate"><span class="pre">syn</span></code> and <code class="docutils literal notranslate"><span class="pre">urg</span></code>. Multiple values are supported, and for
inverted selection use <code class="docutils literal notranslate"><span class="pre">not</span></code>, as shown in the example.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>set firewall ipv4 input filter rule 10 tcp flags &#39;ack&#39;
set firewall ipv4 input filter rule 12 tcp flags &#39;syn&#39;
set firewall ipv4 input filter rule 13 tcp flags not &#39;fin&#39;
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-state-established-invalid-new-related">
set firewall ipv4 forward filter rule &lt;1-999999&gt; state [established | invalid | new | related]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-state-established-invalid-new-related" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-state-established-invalid-new-related">
set firewall ipv4 input filter rule &lt;1-999999&gt; state [established | invalid | new | related]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-state-established-invalid-new-related" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-state-established-invalid-new-related">
set firewall ipv4 output filter rule &lt;1-999999&gt; state [established | invalid | new | related]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-state-established-invalid-new-related" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-state-established-invalid-new-related">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; state [established | invalid | new | related]</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-state-established-invalid-new-related" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match against the state of a packet.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-startdate-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; time startdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-startdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-startdate-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; time startdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-startdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-startdate-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; time startdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-startdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-startdate-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; time startdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-startdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-starttime-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; time starttime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-starttime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-starttime-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; time starttime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-starttime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-starttime-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; time starttime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-starttime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-starttime-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; time starttime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-starttime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-stopdate-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; time stopdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-stopdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-stopdate-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; time stopdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-stopdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-stopdate-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; time stopdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-stopdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-stopdate-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; time stopdate &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-stopdate-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-stoptime-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; time stoptime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-stoptime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-stoptime-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; time stoptime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-stoptime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-stoptime-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; time stoptime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-stoptime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-stoptime-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; time stoptime &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-stoptime-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-weekdays-text">
set firewall ipv4 forward filter rule &lt;1-999999&gt; time weekdays &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-time-weekdays-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-weekdays-text">
set firewall ipv4 input filter rule &lt;1-999999&gt; time weekdays &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-time-weekdays-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-weekdays-text">
set firewall ipv4 output filter rule &lt;1-999999&gt; time weekdays &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-time-weekdays-text" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-weekdays-text">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; time weekdays &lt;text&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-time-weekdays-text" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Time to match the defined rule.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-ttl-eq-gt-lt-0-255">
set firewall ipv4 forward filter rule &lt;1-999999&gt; ttl &lt;eq | gt | lt&gt; &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-ttl-eq-gt-lt-0-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-ttl-eq-gt-lt-0-255">
set firewall ipv4 input filter rule &lt;1-999999&gt; ttl &lt;eq | gt | lt&gt; &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-ttl-eq-gt-lt-0-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-ttl-eq-gt-lt-0-255">
set firewall ipv4 output filter rule &lt;1-999999&gt; ttl &lt;eq | gt | lt&gt; &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-ttl-eq-gt-lt-0-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-ttl-eq-gt-lt-0-255">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; ttl &lt;eq | gt | lt&gt; &lt;0-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-ttl-eq-gt-lt-0-255" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match time to live parameter, where ‘eq’ stands for ‘equal’; ‘gt’ stands for
‘greater than’, and ‘lt’ stands for ‘less than’.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-count-1-255">
set firewall ipv4 forward filter rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-count-1-255">
set firewall ipv4 input filter rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-count-1-255">
set firewall ipv4 output filter rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-count-1-255">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; recent count &lt;1-255&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-count-1-255" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 forward filter rule &lt;1-999999&gt; recent time &lt;second | minute | hour&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 input filter rule &lt;1-999999&gt; recent time &lt;second | minute | hour&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 output filter rule &lt;1-999999&gt; recent time &lt;second | minute | hour&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-time-second-minute-hour">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; recent time &lt;second | minute | hour&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-recent-time-second-minute-hour" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match when ‘count’ amount of connections are seen within ‘time’. These
matching criteria can be used to block brute-force attempts.</p>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-conntrack-helper-module">
set firewall ipv4 forward filter rule &lt;1-999999&gt; conntrack-helper &lt;module&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-forward-filter-rule-1-999999-conntrack-helper-module" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-conntrack-helper-module">
set firewall ipv4 input filter rule &lt;1-999999&gt; conntrack-helper &lt;module&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-filter-rule-1-999999-conntrack-helper-module" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-conntrack-helper-module">
set firewall ipv4 output filter rule &lt;1-999999&gt; conntrack-helper &lt;module&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-output-filter-rule-1-999999-conntrack-helper-module" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-conntrack-helper-module">
set firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt; conntrack-helper &lt;module&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-name-name-rule-1-999999-conntrack-helper-module" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<p>Match based on connection tracking protocol helper module to secure use of
that helper module. See below for possible completions <cite>&lt;module&gt;</cite>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Possible completions:
    ftp                  Related traffic from FTP helper
    h323                 Related traffic from H.323 helper
    pptp                 Related traffic from PPTP helper
    nfs                  Related traffic from NFS helper
    sip                  Related traffic from SIP helper
    tftp                 Related traffic from TFTP helper
    sqlnet               Related traffic from SQLNet helper
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="synproxy">
<h2>Synproxy<a class="headerlink" href="#synproxy" title="Link to this heading"></a></h2>
<p>Synproxy connections</p>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-action-synproxy">
set firewall ipv4 [input | forward] filter rule &lt;1-999999&gt; action synproxy</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-action-synproxy" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-protocol-tcp">
set firewall ipv4 [input | forward] filter rule &lt;1-999999&gt; protocol tcp</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-protocol-tcp" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-synproxy-tcp-mss-501-65535">
set firewall ipv4 [input | forward] filter rule &lt;1-999999&gt; synproxy tcp mss &lt;501-65535&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-synproxy-tcp-mss-501-65535" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<blockquote>
<div><p>Set TCP-MSS (maximum segment size) for the connection</p>
</div></blockquote>
</div>
</div>
<div class="cmd cmd-cfg">
<div class="cfgcmd-heading">
<span class="cfgcmd" id="cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-synproxy-tcp-window-scale-1-14">
set firewall ipv4 [input | forward] filter rule &lt;1-999999&gt; synproxy tcp window-scale &lt;1-14&gt;</span>
<a class="cmdlink" href="#cfgcmd-set-firewall-ipv4-input-forward-filter-rule-1-999999-synproxy-tcp-window-scale-1-14" title="Permalink to this Command"></a></div><div class="cfgcmd-body">
<blockquote>
<div><p>Set the window scale factor for TCP window scaling</p>
</div></blockquote>
</div>
</div>
<section id="example-synproxy">
<h3>Example synproxy<a class="headerlink" href="#example-synproxy" title="Link to this heading"></a></h3>
<p>Requirements to enable synproxy:</p>
<blockquote>
<div><ul class="simple">
<li><p>Traffic must be symmetric</p></li>
<li><p>Synproxy relies on syncookies and TCP timestamps, ensure these are enabled</p></li>
<li><p>Disable conntrack loose track option</p></li>
</ul>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>set system sysctl parameter net.ipv4.tcp_timestamps value &#39;1&#39;

set system conntrack tcp loose disable
set system conntrack ignore ipv4 rule 10 destination port &#39;8080&#39;
set system conntrack ignore ipv4 rule 10 protocol &#39;tcp&#39;
set system conntrack ignore ipv4 rule 10 tcp flags syn

set firewall global-options syn-cookies &#39;enable&#39;
set firewall ipv4 input filter rule 10 action &#39;synproxy&#39;
set firewall ipv4 input filter rule 10 destination port &#39;8080&#39;
set firewall ipv4 input filter rule 10 inbound-interface name &#39;eth1&#39;
set firewall ipv4 input filter rule 10 protocol &#39;tcp&#39;
set firewall ipv4 input filter rule 10 synproxy tcp mss &#39;1460&#39;
set firewall ipv4 input filter rule 10 synproxy tcp window-scale &#39;7&#39;
set firewall ipv4 input filter rule 1000 action &#39;drop&#39;
set firewall ipv4 input filter rule 1000 state invalid
</pre></div>
</div>
</section>
</section>
<section id="operation-mode-firewall">
<h2>Operation-mode Firewall<a class="headerlink" href="#operation-mode-firewall" title="Link to this heading"></a></h2>
<section id="rule-set-overview">
<h3>Rule-set overview<a class="headerlink" href="#rule-set-overview" title="Link to this heading"></a></h3>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-firewall">
show firewall</span>
<a class="cmdlink" href="#opcmd-show-firewall" title="Permalink to this Command"></a></div><div class="opcmd-body">
<p>This will show you a basic firewall overview, for all ruleset, and not
only for ipv4</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vyos@vyos:~$ show firewall
Rulesets Information

---------------------------------
ipv4 Firewall &quot;forward filter&quot;

Rule     Action    Protocol      Packets    Bytes  Conditions
-------  --------  ----------  ---------  -------  -----------------------------
20       accept    all                 0        0  ip saddr @N_TRUSTEDv4  accept
21       jump      all                 0        0  jump NAME_AUX
default  accept    all                 0        0

---------------------------------
ipv4 Firewall &quot;input filter&quot;

Rule     Action    Protocol      Packets    Bytes  Conditions
-------  --------  ----------  ---------  -------  -------------------------
10       accept    all               156    14377  iifname != @I_LAN  accept
default  accept    all                 0        0

---------------------------------
ipv4 Firewall &quot;name AUX&quot;

  Rule  Action    Protocol      Packets    Bytes  Conditions
------  --------  ----------  ---------  -------  --------------------------------------------
    10  accept    icmp                0        0  meta l4proto icmp  accept
    20  accept    udp                 0        0  meta l4proto udp ip saddr @A_SERVERS  accept
    30  drop      all                 0        0  ip saddr != @A_SERVERS iifname &quot;eth2&quot;

---------------------------------
ipv4 Firewall &quot;output filter&quot;

Rule     Action    Protocol      Packets    Bytes  Conditions
-------  --------  ----------  ---------  -------  ----------------------------------------
10       reject    all                 0        0  oifname @I_LAN
20       accept    icmp                2      168  meta l4proto icmp oifname &quot;eth0&quot;  accept
default  accept    all                72     9258

---------------------------------
ipv6 Firewall &quot;input filter&quot;

Rule     Action    Protocol      Packets    Bytes  Conditions
-------  --------  ----------  ---------  -------  -------------------------------
10       accept    all                 0        0  ip6 saddr @N6_TRUSTEDv6  accept
default  accept    all                 2      112

vyos@vyos:~$
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-firewall-summary">
show firewall summary</span>
<a class="cmdlink" href="#opcmd-show-firewall-summary" title="Permalink to this Command"></a></div><div class="opcmd-body">
<p>This will show you a summary of rule-sets and groups</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vyos@vyos:~$ show firewall summary
Ruleset Summary

IPv6 Ruleset:

Ruleset Hook    Ruleset Priority      Description
--------------  --------------------  -------------------------
forward         filter
input           filter
ipv6_name       IPV6-VyOS_MANAGEMENT
ipv6_name       IPV6-WAN_IN           PUBLIC_INTERNET

IPv4 Ruleset:

Ruleset Hook    Ruleset Priority    Description
--------------  ------------------  -------------------------
forward         filter
input           filter
name            VyOS_MANAGEMENT
name            WAN_IN              PUBLIC_INTERNET

Firewall Groups

Name                     Type                References               Members
-----------------------  ------------------  -----------------------  ----------------
PBX                      address_group       WAN_IN-100               198.51.100.77
SERVERS                  address_group       WAN_IN-110               192.0.2.10
                                             WAN_IN-111               192.0.2.11
                                             WAN_IN-112               192.0.2.12
                                             WAN_IN-120
                                             WAN_IN-121
                                             WAN_IN-122
SUPPORT                  address_group       VyOS_MANAGEMENT-20       192.168.1.2
                                             WAN_IN-20
PHONE_VPN_SERVERS        address_group       WAN_IN-160               10.6.32.2
PINGABLE_ADRESSES        address_group       WAN_IN-170               192.168.5.2
                                             WAN_IN-171
PBX                      ipv6_address_group  IPV6-WAN_IN-100          2001:db8::1
SERVERS                  ipv6_address_group  IPV6-WAN_IN-110          2001:db8::2
                                             IPV6-WAN_IN-111          2001:db8::3
                                             IPV6-WAN_IN-112          2001:db8::4
                                             IPV6-WAN_IN-120
                                             IPV6-WAN_IN-121
                                             IPV6-WAN_IN-122
SUPPORT                  ipv6_address_group  IPV6-VyOS_MANAGEMENT-20  2001:db8::5
                                             IPV6-WAN_IN-20
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-firewall-ipv4-forward-input-output-filter">
show firewall ipv4 [forward | input | output] filter</span>
<a class="cmdlink" href="#opcmd-show-firewall-ipv4-forward-input-output-filter" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-firewall-ipv4-name-name">
show firewall ipv4 name &lt;name&gt;</span>
<a class="cmdlink" href="#opcmd-show-firewall-ipv4-name-name" title="Permalink to this Command"></a></div><div class="opcmd-body">
<p>This command will give an overview of a single rule-set.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vyos@vyos:~$ show firewall ipv4 input filter
Ruleset Information

---------------------------------
IPv4 Firewall &quot;input filter&quot;

Rule     Action    Protocol      Packets    Bytes  Conditions
-------  --------  ----------  ---------  -------  -----------------------------------------
5        jump      all                 0        0  iifname &quot;eth2&quot;  jump NAME_VyOS_MANAGEMENT
default  accept    all
</pre></div>
</div>
</div>
</div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-firewall-ipv4-forward-input-output-filter-rule-1-999999">
show firewall ipv4 [forward | input | output] filter rule &lt;1-999999&gt;</span>
<a class="cmdlink" href="#opcmd-show-firewall-ipv4-forward-input-output-filter-rule-1-999999" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-firewall-ipv4-name-name-rule-1-999999">
show firewall ipv4 name &lt;name&gt; rule &lt;1-999999&gt;</span>
<a class="cmdlink" href="#opcmd-show-firewall-ipv4-name-name-rule-1-999999" title="Permalink to this Command"></a></div><div class="opcmd-body">
<p>This command will give an overview of a rule in a single rule-set, plus
information for default action.</p>
</div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vyos@vyos:~$show firewall ipv4 output filter rule 20
Rule Information

---------------------------------
ipv4 Firewall &quot;output filter&quot;

Rule     Action    Protocol      Packets    Bytes  Conditions
-------  --------  ----------  ---------  -------  ----------------------------------------
20       accept    icmp                2      168  meta l4proto icmp oifname &quot;eth0&quot;  accept
default  accept    all               286    47614

vyos@vyos:~$
</pre></div>
</div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-firewall-statistics">
show firewall statistics</span>
<a class="cmdlink" href="#opcmd-show-firewall-statistics" title="Permalink to this Command"></a></div><div class="opcmd-body">
<p>This will show you a statistic of all rule-sets since the last boot.</p>
</div>
</div>
</section>
<section id="show-firewall-log">
<h3>Show Firewall log<a class="headerlink" href="#show-firewall-log" title="Link to this heading"></a></h3>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-log-firewall">
show log firewall</span>
<a class="cmdlink" href="#opcmd-show-log-firewall" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-log-firewall-ipv4">
show log firewall ipv4</span>
<a class="cmdlink" href="#opcmd-show-log-firewall-ipv4" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-log-firewall-ipv4-forward-input-output-name">
show log firewall ipv4 [forward | input | output | name]</span>
<a class="cmdlink" href="#opcmd-show-log-firewall-ipv4-forward-input-output-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-log-firewall-ipv4-forward-input-output-filter">
show log firewall ipv4 [forward | input | output] filter</span>
<a class="cmdlink" href="#opcmd-show-log-firewall-ipv4-forward-input-output-filter" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-log-firewall-ipv4-name-name">
show log firewall ipv4 name &lt;name&gt;</span>
<a class="cmdlink" href="#opcmd-show-log-firewall-ipv4-name-name" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-log-firewall-ipv4-forward-input-output-filter-rule-rule">
show log firewall ipv4 [forward | input | output] filter rule &lt;rule&gt;</span>
<a class="cmdlink" href="#opcmd-show-log-firewall-ipv4-forward-input-output-filter-rule-rule" title="Permalink to this Command"></a></div></div>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-show-log-firewall-ipv4-name-name-rule-rule">
show log firewall ipv4 name &lt;name&gt; rule &lt;rule&gt;</span>
<a class="cmdlink" href="#opcmd-show-log-firewall-ipv4-name-name-rule-rule" title="Permalink to this Command"></a></div><div class="opcmd-body">
<p>Show the logs of all firewall; show all ipv4 firewall logs; show all logs
for particular hook; show all logs for particular hook and priority;
show all logs for particular custom chain; show logs for specific Rule-Set.</p>
</div>
</div>
</section>
<section id="example-partial-config">
<h3>Example Partial Config<a class="headerlink" href="#example-partial-config" title="Link to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>firewall {
    group {
        network-group BAD-NETWORKS {
            network 198.51.100.0/24
            network 203.0.113.0/24
        }
        network-group GOOD-NETWORKS {
            network 192.0.2.0/24
        }
        port-group BAD-PORTS {
            port 65535
        }
    }
    ipv4 {
        forward {
            filter {
                default-action accept
                rule 5 {
                    action accept
                    source {
                        group {
                            network-group GOOD-NETWORKS
                        }
                    }
                }
                rule 10 {
                    action drop
                    description &quot;Bad Networks&quot;
                    protocol all
                    source {
                        group {
                            network-group BAD-NETWORKS
                        }
                    }
                }
            }
        }
    }
}
</pre></div>
</div>
</section>
<section id="update-geoip-database">
<h3>Update geoip database<a class="headerlink" href="#update-geoip-database" title="Link to this heading"></a></h3>
<div class="cmd cmd-op">
<div class="opcmd-heading">
<span class="opcmd" id="opcmd-update-geoip">
update geoip</span>
<a class="cmdlink" href="#opcmd-update-geoip" title="Permalink to this Command"></a></div><div class="opcmd-body">
<p>Command used to update GeoIP database and firewall sets.</p>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bridge.html" class="btn btn-neutral float-left" title="Bridge Firewall Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ipv6.html" class="btn btn-neutral float-right" title="IPv6 Firewall Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2023, VyOS maintainers and contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>